<div ng-include src="'shared/masthead.html'"></div>
<section ng-hide="user">
  <div class="hero">
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <div class="text-center info-message">
            <h2>Please <a href="#/login">log in</a> to access schedule call</h2>
            <p>Don't have an account yet, <a href="#/signup">sign up now</a> for free.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<div ng-show="user">
  <div ng-show="user.role_type == 'Member'">
    <!-- call details -->
    <div class="detailForm" ng-show="callRequestModel.form == 'cal_details'">

      <form novalidate role="form" name="callDetailForm" class="css-form">
        <h1>Call Details</h1>
          <div class="formBox">
            <div class="formHeading">
                <h3>Letâ€™s Schedule a Call with {{mentor.full_name}}</h3>
                  <span>STEP 1 of 4</span>
              </div>
              <div class="formContent">
                <div class="userNameImg">
                    <span class="noImage"><img src="{{mentor.avatar}}" start-inline-edit/></span>
                    <label>${{mentor.rate_per_minute}}/minute</label>
                  </div>
                  <div class="formRow">
                    <label>1) What would you like ${{mentor.full_name}} to focus on for this call?<span>  ({{280 - callRequestModel.agenda.length}} characters left)</span></label>
                    <textarea class="form-control width65" rows="3" ng-model="callRequestModel.agenda" required="" maxlength="280"></textarea>
                  </div>
                  <div class="formRow">
                    <label>2) Roughly speaking, how long would you like this call to last?</label>
                    <select data-ng-options="o.name for o in proposedDurationOptions" ng-model="callRequestModel.proposed_duration" class="form-control width65"></select>
                  </div>
                  <div class="formRow">
                    <p>Please note that your call can go over the amount of time you choose! This is just to give our Mentors a rough estimate on how long to expect the call to last.</p>
                  </div>
              </div>
          </div>
          <div class="bottomBtn">
            <a href="#" class="btn btn-back fleft">Back</a>
            <button class="btn btn-continue fright" type="button" ng-disabled="callDetailForm.$invalid" ng-click="availableTimes()">Continue</button>
          </div>
        </form>
    </div>

    <!-- Availabel times -->
    <div class="detailForm" ng-show="callRequestModel.form == 'avl_times'">
      <form novalidate role="form" name="avlTimeForm" class="css-form">
        <div class="formBox">
          <div class="formHeading">
              <h3>Best Available times for {{mentor.full_name}}</h3>
              <span>STEP 2 of 4</span>
            </div>
            <div class="formContent">
              <div class="bestTimeTakeCall">
                <label>Here are the best time that {{mentor.full_name}} is available to take calls</label>
                <div class="bestTimeDigit"><span>{{ mentor.availability }}</span></div>
              <label>{{mentor.full_name}} located in the {{mentor.time_zone}} Timezone.</label>
              </div>
              <div class="formRow">
                <div class="suggestTime">
                  <label>1) Suggest a time <span>(in your timezone)</span> for {{mentor.full_name}} to accept a call. The {{mentor.full_name}} has the option of accepting your time or can reply back with another time that might be a better fit.</label>
                  <input type="text" class="form-control width40 fleft" id="scheduled_at" placeholder="Schedule Date" datepicker ng-model="callRequestModel.scheduled_at" required="">
                  <span class="atText fleft">at</span>
                  <input ng-model="callRequestModel.scheduled_time"  id="scheduled_time" placeholder="Schedule Time" timepicker class="form-control width40 fleft" required="">
                </div>
              </div>
              <div class="formRow">
                <p>Note: We don't recommend requesting a call within 12 hours, as our {{mentor.full_name}} might not be able to respond back in time. Please also be courteous of any timezone differences.</p>
              </div>
            </div>
        </div>
        <div class="bottomBtn">
          <button class="btn btn-back fleft" type="button" ng-click="calDetails()">Back</button>
          <button class="btn btn-continue fright" type="button" ng-disabled="avlTimeForm.$invalid" ng-click="PaymentInfo()">Continue</button>
        </div>
      </form>
    </div>

    <!-- Payment Info -->
    <div class="detailForm" ng-show="callRequestModel.form == 'payment_info'">
      <form novalidate role="form" name="paymentInfoForm" class="css-form">
        <div class="formBox">
          <div class="formHeading">
            <h3>Please enter your payment information</h3>
            <span>STEP 3 of 4</span>
          </div>
          <div class="formContent">
            <div class="formRow">
              <div class="creditCardDetail">
                <label>Your credit card will not be charged until after the call is complete.</label>
                <input type="text" class="form-control width40" ng-model="callRequestModel.card_number" placeholder="Credit Card #" required="">
                <input type="text" class="form-control width10" ng-model="callRequestModel.security_code" placeholder="CVC" required="" maxlength="4">
              </div>
            </div>
            <div class="formRow">
              <div class="expireDateDetail">
                <label>Expiration Date?</label>
                <select class="form-control width40 fleft" ng-model="callRequestModel.expired_month" data-ng-options="o.name for o in expiredMonths"></select>
                <select class="form-control width40" ng-model="callRequestModel.expired_year" data-ng-options="o.name for o in expiredYears"></select>
              </div>
            </div>

            <div class="formRow">
              <div class="expireDateDetail">
                <span class="text-danger">{{creditCardError}}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="bottomBtn">
          <button class="btn btn-back fleft" type="button" ng-click="availableTimes()">Back</button>
          <button class="btn btn-continue fright" type="button" ng-disabled="paymentInfoForm.$invalid" ng-click="ConfirmDetails()">Continue</button>
        </div>
      </form>
    </div>

    <!-- confirm details -->
    <div class="detailForm" ng-show="callRequestModel.form == 'confirm_details'">
      <form novalidate role="form" name="confirmDetailForm" class="css-form">
        <div class="formBox">
          <div class="formHeading">
            <h3>Confirm Details for call</h3>
            <span>STEP 4 of 4</span>
          </div>
          <div class="formContent">
            <div class="formRow">
              <div class="suggestTime">
                <label>1) Reason for your call</label>
                <span class="atText fleft">{{ callRequestModel.agenda }}</span>
              </div>
            </div>
            <div class="formRow">
              <div class="suggestTime">
                <label>2) Suggested Time</label>
                <span class="atText fleft">{{ callRequestModel.scheduled_at | date:'EEEE, MMMM dd, yyyy' }} at {{ callRequestModel.scheduled_time }}</span>

              </div>
            </div>
            <div class="formRow">
              <div class="estimatedTotal">
                <label>3) Estimated Total</label>
                <table cellpadding="0" cellspacing="0" border="0" width="100%">
                  <tr>
                    <td width="50%"><span>Rate per Minute</span></td>
                    <td width="50%"><span>${{mentor.rate_per_minute}}</span></td>
                  </tr>
                  <tr>
                    <td><span>Requested call length</span></td>
                      <td><span>{{ callRequestModel.proposed_duration.id }} minutes</span></td>
                  </tr>
                  <tr>
                    <td><span>Estimated Cost</span></td>
                      <td><span>{{ callRequestModel.proposed_duration.id * mentor.rate_per_minute | currency:"$"}}  </span></td>
                  </tr>
                </table>
              </div>
            </div>
            <div class="formRow">
              <p>How to enter call: A Conference line number will be provided once the call is confirmed. Your credit card will not be charged until after call is complete.</p>
            </div>
          </div>
        </div>
        <div class="bottomBtn">
          <button class="btn btn-back fleft" type="button" ng-click="PaymentInfo()">Back</button>
          <button class="btn btn-continue fright" type="button" ng-click="SubmitCallRequest()">Continue</button>
        </div>
      </div>
  </div>

</div>